Difficult problem in this fileHere is the starting point